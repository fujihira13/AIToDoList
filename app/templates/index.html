<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>\u30a2\u30a4\u30bc\u30f3\u30cf\u30ef\u30fc\u30dc\u30fc\u30c9</title>
    <link rel="stylesheet" href="/static/style.css" />
  </head>
  <body>
    <header class="page-header">
      <div>
        <p class="page-label">{{ copy.page_label }}</p>
        <h1>{{ copy.page_title }}</h1>
        <p class="page-sub">{{ copy.page_sub }}</p>
      </div>
      <div class="header-actions">
        <button type="button" class="btn btn--primary" id="addTaskBtn">
          {{ copy.add_task }}
        </button>
        <div class="tips">
          <p>{{ copy.hint_title }}</p>
          <code>uvicorn app.main:app --reload</code>
        </div>
      </div>
    </header>

    <main class="layout">
      <section class="board" id="board" aria-live="polite"></section>
      <aside class="staff-panel">
        <div class="staff-panel__header">
          <h2>{{ copy.staff_title }}</h2>
          <p>{{ copy.staff_sub }}</p>
        </div>
        <div id="staffList" class="staff-list"></div>
      </aside>
    </main>

    <dialog id="taskDialog" class="modal">
      <form id="taskForm" method="dialog">
        <header class="modal__header">
          <h2
            id="taskFormTitle"
            data-create-label="{{ copy.form_create }}"
            data-edit-label="{{ copy.form_edit }}"
          >
            {{ copy.form_create }}
          </h2>
          <button type="button" class="btn btn--ghost" id="cancelTaskBtn">
            {{ copy.cancel }}
          </button>
        </header>
        <input type="hidden" name="task_id" id="task_id" />

        <div class="form-grid">
          <label class="form-field">
            <span>\u30bf\u30a4\u30c8\u30eb *</span>
            <input type="text" name="title" id="title" maxlength="80" required />
          </label>

          <label class="form-field">
            <span>\u62c5\u5f53\u8005 *</span>
            <select name="owner_id" id="owner_id" required>
              <option value="" disabled selected>--</option>
              {% for person in staff %}
              <option value="{{ person.id }}">{{ person.name }}</option>
              {% endfor %}
            </select>
            <small id="ownerDept" class="helper-text"></small>
          </label>

          <label class="form-field">
            <span>\u30b9\u30c6\u30fc\u30bf\u30b9</span>
            <select name="status" id="status">
              {% for option in status_options %}
              <option value="{{ option.value }}">{{ option.label }}</option>
              {% endfor %}
            </select>
          </label>

          <label class="form-field">
            <span>\u512a\u5148\u5ea6</span>
            <select name="priority" id="priority">
              {% for option in priority_options %}
              <option value="{{ option.value }}">{{ option.label }}</option>
              {% endfor %}
            </select>
          </label>

          <label class="form-field">
            <span>\u8c61\u9650</span>
            <select name="quadrant" id="quadrant">
              {% for quadrant in [1, 2, 3, 4] %}
              <option value="{{ quadrant }}">\u7b2c{{ quadrant }}\u8c61\u9650 - {{ quadrant_labels[quadrant] }}</option>
              {% endfor %}
            </select>
          </label>

          <label class="form-field">
            <span>\u671f\u9650</span>
            <input type="date" name="due_date" id="due_date" />
          </label>

          <label class="form-field">
            <span>\u4f5c\u6210\u8005</span>
            <input type="text" name="created_by" id="created_by" />
          </label>
        </div>

        <label class="form-field">
          <span>\u8a73\u7d30</span>
          <textarea name="description" id="description" rows="4" maxlength="500"></textarea>
        </label>

        <footer class="modal__footer">
          <span id="formStatus" class="form-status" role="status"></span>
          <div class="modal__actions">
            <button type="button" class="btn btn--danger" id="deleteTaskBtn">
              {{ copy.delete_task }}
            </button>
            <button type="submit" class="btn btn--primary">{{ copy.save_task }}</button>
          </div>
        </footer>
      </form>
    </dialog>

    <dialog id="confirmDialog" class="modal modal--confirm">
      <div class="modal__body">
        <p id="confirmMessage">{{ copy.confirm_delete }}</p>
      </div>
      <div class="modal__actions">
        <button type="button" class="btn btn--ghost" id="confirmCancelBtn">
          {{ copy.cancel }}
        </button>
        <button type="button" class="btn btn--danger" id="confirmDeleteBtn">
          {{ copy.confirm }}
        </button>
      </div>
    </dialog>

    <footer class="page-footer">
      <p>{{ copy.footnote }}</p>
    </footer>

    <script id="initial-data" type="application/json">{{ initial_payload | tojson }}</script>
    <script src="/static/app.js" defer></script>
  </body>
</html>
